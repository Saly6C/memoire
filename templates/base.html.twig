{% extends "_partial.html.twig" %}

{% block body %}
{# {{dump()}} #}
	{% if app.user.status == 'actif' %}
	<div
		class="container-fluid py-3 mt-2 bgc-contenu">
		<!-- header -->
		<div class=" d-flex text-white py-2 rounded-lg banner">
			<div class="d-flex col-4 align-items-center pl-0">
				<a href="{{ path('clinic_dashboard') }}"><i class="fas fa-clinic-medical fa-4x pl-1 pr-2 text-white " data-toggle="tooltip" data-placement="top" title="Retourner à l'accueil"></i></a>
				<span class="font-weight-bold">SamaClinique</span>
			</div>
			<div class="d-flex col-4 justify-content-center align-items-center font-weight-bold">Bienvenue, {{ app.user.username }}</span></div>
			<div class="d-flex col-4 float-right justify-content-center align-items-center">
				<input class="form-control mr-sm-2" type="search" placeholder="Rechercher" aria-label="Search" id="rechercher">
				<button class="btn" type="submit">
					<i class="fas fa-search text-white" aria-hidden="true"></i>
				</button>
			</div>
		</div>

		<!-- content -->
		<div
			class="d-flex mt-3 mt-3">
			<!-- left content -->
			<div class="list-group col-3 ">
				{# profile #}
				<a class="list-group-item list-group-item-action active"  href="#" >
					<img src="{{asset('/images/user-default.jpg')}}" alt="user-img" class="img-fluid rounded-circle p-5">
				</a>
				{# consultation #}
			{% block consultation %}
				<a class="list-group-item list-group-item-action block_consultation" href="{{ path('consultation_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-user-md"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Consultation</span>
						<span class="col-2 consultation d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>	
			{% endblock %}

			{% block hospitalisation %}
				{# hospitalisation #}
				<a class="list-group-item list-group-item-action block_hospitalisation" href="{{ path('hospitalisation_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-procedures"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Hospitalisation</span>
						<span class="col-2 hospitalisation d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{% endblock %}

			{% block dossier_patient %}
				{# dossier patient #}
				<a class="list-group-item list-group-item-action block_dossier_patient" href="{{ path('dossier_patient_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-address-book"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Dossier Patient</span>
						<span class="col-2 dossierPatient d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{% endblock %}

			{% block patient %}
				
				{# patient #}
				<a class="list-group-item list-group-item-action block_patient" href="{{ path('patient_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-user-injured"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Patient</span>
						<span class="col-2 patient d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
				{% endblock %}
			{% block personnel %}
				{# personnel #}
				<a class="list-group-item list-group-item-action block_personnel" href="{{ path('personnel_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-users"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Personnels</span>
						<span class="col-2 patient d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{% endblock %}

			{% block service %}
				{# service  #}
				<a class="list-group-item list-group-item-action block_service" href="{{ path('service_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-building"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Services</span>
						<span class="col-2 patient d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{% endblock %}

			{% block chambre %}
				{# chambre #}
				<a class="list-group-item list-group-item-action block_chambre" href="{{ path('chambre_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fa fa-bed"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Chambre</span>
						<span class="col-2 patient d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{% endblock %}

			{% block rendez_vous %}
				{# rendez-vous  #}
				<a class="list-group-item list-group-item-action block_rendez_vous" href="{{ path('rendez_vous_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-calendar"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Rendez-vous</span>
						<span class="col-2 patient d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{% endblock %}

			{% block facturation %}
				{# facturation #}
				<a class="list-group-item list-group-item-action block_facturation" href="{{ path('facturation_index') }}">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-hand-holding-usd"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Facturation</span>
						<span class="col-2 patient d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{% endblock %}

			{# {% block  %} #}
				{# parametre #}
				<a class="list-group-item list-group-item-action" href="#list-settings">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-cogs"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Paramètre</span>
						<span class="col-2 parametre d-flex justify-content-center align-items-center">
							<i class="test fas fa-angle-right"></i>
						</span>
					</div>
				</a>
			{# {% endblock %} #}

			{% block users  %}
				{# gestion utilisateurs #}
				{% for role in app.user.roles %}
					{% if role == "Admin" %}
					<a class="list-group-item list-group-item-action block_users" href="{{path('user_index')}}" data-toggle="tooltip" data-placement="top" title="Cliquez pour vous déconnectez">
						<div class="d-flex">
							<span class="col-2">
								<i class="fas fa-users"></i>
							</span>
							<span class="col-8 d-flex justify-content-center font-weight-bold">Utilisateurs</span>
							
							<span class="col-2 d-flex justify-content-center align-items-center"><i class="test fas fa-angle-right"></i></span>
						</div>
					</a>
					{% endif %}
				{% endfor %}
			{% endblock %}	

				{# deconnection #}
				<a class="list-group-item list-group-item-action" href="{{path('clinic_logout')}}" data-toggle="tooltip" data-placement="top" title="Cliquez pour vous déconnectez">
					<div class="d-flex">
						<span class="col-2">
							<i class="fas fa-sign-out-alt"></i>
						</span>
						<span class="col-8 d-flex justify-content-center font-weight-bold">Se déconnecter</span>
						
						<span class="col-2 d-flex justify-content-center align-items-center"><i class="test fas fa-angle-right"></i></span>
					</div>
				</a>
				</div>
			<!-- right content -->
			<div class="col-9  px-0 right_content rounded">
				<div class="m-2 bg-white">
					{% for message in app.flashes('success') %}
						<div class="alert alert-success" id="msgFlash">
							{{ message }}
						</div>
					{% endfor %}
					{% block content %}
						<div class="container pb-2 pl-0 bg-light">
							<div class="row font-weight-bold p-2 ml-0 border-bottom pl-4 py-3"><i class="fas fa-chart-bar mr-2  fa-2x"></i> Statistiques</div>
							<div class="d-flex pt-4">
								{# compte actif #}
								<div class="col-4 text-white">
									<div class="col-12 d-flex compte_actif mx-2">
										{% set count = 0 %}
										{% for compte in compteActif %}
											{% set count = count + 1 %}
										{% endfor %}
										<div class="col-10 font-weight-bold pl-0 pt-1">Comptes actifs</div>
										<div class="col-2 font-weight-bold" style="font-size: xxx-large;">{{count}}</div>
									</div>
								</div>
								{# nombre total de patient #}
								<div class="col-4 text-white">
									<div class="col-12 d-flex  compte_actif mx-2">
										<div class="col-10 font-weight-bold pl-0 pt-1">Total patients</div>
										{% for total in totalPatient %}
											<div class="col-2 font-weight-bold" style="font-size: xxx-large;">{{total.totalPatient}}</div>
										{% endfor %}
										</div>
								</div>
								{# nombre total chambres #}
								<div class="col-4 text-white">
									<div class="col-12 d-flex  compte_actif mx-2">
										<div class="col-10 font-weight-bold pl-0 pt-1">Total Chambres</div>
										{% for chambre in totalChambre %}
											<div class="col-2 font-weight-bold" style="font-size: xxx-large;">{{chambre.totalChambre}}</div>
										{% endfor %}
										</div>
								</div>
							</div>
							{# google chart #}
							<div class="d-flex mt-5 border-top border-bottom">
								{# Column Chart =>Nombre consultations par service	 #}
								<div class="col-6" id="columnchart_values">
									{% set array = [] %}
									{% for item in consultationParService %}
										{% set array = array | merge([{nombre: item.nbrConsultation, 
											nomService: item.nomService}]) 
										%}
									{% endfor %}
									<input type="hidden" id="array" value="{{ array|json_encode }}">
								</div>
								{# Pie Chart =>Nombre d'hospitalisation par mois#}
								<div class="col-6" id="chart_div">
									{% set array = [] %}
									{# Mois d'hospitalisation #}
									{% for item in hospitalisationParMois %}
										{# {% set moisHospi = item.mois %} #}
										{% if item.mois == 1 %}
											{% set moisHospi = "Janvier"%}
										{% endif %}

										{% if item.mois == 2 %}
											{% set moisHospi = "Février"%}
										{% endif %}

										{% if item.mois == 3 %}
											{% set moisHospi = "Mars"%}
										{% endif %}

										{% if item.mois == 4 %}
											{% set moisHospi = "Avril"%}
										{% endif %}

										{% if item.mois == 5 %}
											{% set moisHospi = "Mai"%}
										{% endif %}

										{% if item.mois == 6 %}
											{% set moisHospi = "Juin"%}
										{% endif %}

										{% if item.mois == 7 %}
											{% set moisHospi = "Juillet"%}
										{% endif %}

										{% if item.mois == 8 %}
											{% set moisHospi = "Aôut"%}
										{% endif %}

										{% if item.mois == 9 %}
											{% set moisHospi = "Septembre"%}
										{% endif %}

										{% if item.mois == 7 %}
											{% set moisHospi = "Octobre"%}
										{% endif %}

										{% if item.mois == 8 %}
											{% set moisHospi = "Novembre"%}
										{% endif %}

										{% if item.mois == 9 %}
											{% set moisHospi = "Décembre"%}
										{% endif %}
										
										
										{% set array = array | merge([{nbrHospitalisation: item.nbrHospitalisation, 
											mois: moisHospi}]) 
										%}
									{% endfor %}
									<input type="hidden" id="arrayHospitalisation" value="{{ array|json_encode }}">
								</div>
							</div>
							{# lISTE DES DERNIERES CONSULTATIONS #}
							<div class="mt-5 ml-3  mb-2 ">
								<h4 class="text-center py-2 ">Liste des 3 dernières consultations</h4>
								<table class="table table-striped table-hover table-responsive table-borderless ">
									<thead class="derniere_consultation text-white">
										<tr>
											<th scope="col">Id</th>
											<th scope="col">Date Consultation</th>
											<th scope="col">Diagnostic</th>
											<th scope="col">Prochain RV</th>
											<th scope="col">Autre</th>
											<th scope="col">Patient</th>
											<th scope="col">Rendez-Vous</th>
											<th scope="col">Personnel</th>

											{# <th scope="col">actions</th> #}
										</tr>
									</thead>
									<tbody id="consultationList">
									{% for consultation in lastConsultation %}
										<tr>
											<td>{{ consultation.id }}</td>
											<td>{{ consultation.dateConsultation ? consultation.dateConsultation|date('Y-m-d H:i:s') : '' }}</td>
											<td>{{ consultation.diagnostic }}</td>
											<td>{{ consultation.prochainRV }}</td>
											<td>{{ consultation.autre }}</td>
											<td>{{ consultation.patient }}</td>
											<td>{{ consultation.rendezVous }}</td>
											<td>{{ consultation.personnel }}</td>
											
											{# <td>
												<a href="{{ path('consultation_show', {'id': consultation.id}) }}"><i class="fas fa-eye text-dark"></i></a>
												<a href="{{ path('consultation_edit', {'id': consultation.id}) }}"><i class="fas fa-edit text-dark"></i></a>
											</td> #}
										</tr>
									{% else %}
										<tr>
											<td colspan="12">no records found</td>
										</tr>
									{% endfor %}
									</tbody>
								</table>

								<a href="{{ path('consultation_index') }}" class="d-flex pb-2">
									<h6 class="ml-2 text-white">Voir toutes les consultations</h6>
								</a>
							</div>
						</div>
					{% endblock %}
				</div>
			</div>
		</div>

		{# footer #}
		<div class="d-flex text-white py-2 mt-3 pl-3 rounded-lg footer font-weight-bold">
			Copyright © Saly6C 2019, All rights reserved
		</div>
	</div>
	{% else %}
	<div class="d-flex flex-column justify-content-center align-items-center container-fluid bg-warning p-4">
		<img class="img-fluid" src="{{ asset('/images/smiley-face-emoji.png') }}" alt="compte désactivé">
		<h6 class="font-weight-bold">
			Désolé, votre compte est désactivé. Veuillez contacter votre administrateur !
		</h6>
	</div>	
	{% endif %}
	

{% endblock %}
